[%# This Source Code Form is subject to the terms of the Mozilla Public
  # License, v. 2.0. If a copy of the MPL was not distributed with this
  # file, You can obtain one at http://mozilla.org/MPL/2.0/.
  #
  # This Source Code Form is "Incompatible With Secondary Licenses", as
  # defined by the Mozilla Public License, v. 2.0.
  #%]

[% INCLUDE global/header.html.tmpl
  title = "Account Verification"
  javascript_urls = ["js/mfa_totp.js","js/util.js"]
  allow_mobile = 1
%]

<h1>Account Verification</h1>

<p>
  <b>[% reason FILTER html %]</b> requires verification.<br>
  Please enter your verification code from your TOTP application. If your device has been lost or stolen, you
  may use one of your pre-generated recovery codes.
</p>
<div class="verify_totp">
  <form id="verify_totp_form" method="POST" action="[% postback.action FILTER none %]">
    <div>
      <span id="verify_totp_input">
        [% FOREACH field IN postback.fields.keys %]
          <input type="hidden" name="[% field FILTER html %]" value="[% postback.fields.item(field) FILTER html %]">
        [% END %]
        <input type="text" name="code" id="code" data-token="[% token FILTER html %]"
               placeholder="123456" maxlength="9" pattern="\d{6,9}" size="10"
               autocomplete="off" inputmode="numeric" required autofocus>
      </span>
      <span id="verify_totp_error" class="bz_default_hidden"></span>
    </div>
    <input type="submit" value="Submit">
  </form>
</div>

[% INCLUDE global/footer.html.tmpl %]
